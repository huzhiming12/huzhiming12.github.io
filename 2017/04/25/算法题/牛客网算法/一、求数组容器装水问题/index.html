<h1 id="求数组容器装水问题"><a href="#求数组容器装水问题" class="headerlink" title="求数组容器装水问题"></a>求数组容器装水问题</h1><blockquote>
<p>给定一个非负数的数组，代表一个容器。例如数组[0,1,0,2,1,0,1,3,2,1,2,1]，就是以下图形中黑色的部分。如果用这个容器接水的话，请问可以接多少水?还以这个数组为例，可以接 6 格水，就是以下图形中蓝色的部分。要求:实现时间复杂度 O(N)，额外空间复杂度 O(1)的解法</p>
</blockquote>
<p><img src="/2017/04/25/算法题/牛客网算法/一、求数组容器装水问题/pic/pic5.png" alt=""></p>
<p>思路：对每一格装水量进行计算，第i格能装水的量 :</p>
<p>​            value[i]=Min{max{arr[0],arr[1],……arr[i-1]}, max{arr[i+1],arr[i+2],……arr[n]}} - arr[i];</p>
<p>即value[i] 就是找i左边最大值和i右边的最大值，取这两个最大值得较小值最为瓶颈，最后减去arr[i]，就是它的装水量。</p>
<h4 id="解法一"><a href="#解法一" class="headerlink" title="解法一"></a>解法一</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getWater</span><span class="params">(<span class="keyword">int</span>[] arr)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">     	<span class="comment">//用数组leftMax 记录从0到i-1中最大的数</span></div><div class="line">	<span class="keyword">int</span>[] leftMax = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</div><div class="line">     	<span class="comment">//用数组rightMax 记录从i+1到n中的最大值</span></div><div class="line">	<span class="keyword">int</span>[] rightMax = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</div><div class="line">	<span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++)</div><div class="line">	&#123;</div><div class="line">		leftMax[i] = max = max &lt; arr[i] ? arr[i] : max;</div><div class="line">	&#125;</div><div class="line">	max = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = arr.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">	&#123;</div><div class="line">		rightMax[i] = max = max &lt; arr[i] ? arr[i] : max;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr.length - <span class="number">1</span>; i++)</div><div class="line">	&#123;</div><div class="line">         	<span class="comment">//求两个最大值中的较小值</span></div><div class="line">		<span class="keyword">int</span> min = leftMax[i - <span class="number">1</span>] &gt; rightMax[i + <span class="number">1</span>] ? rightMax[i + <span class="number">1</span>] : leftMax[i - <span class="number">1</span>];</div><div class="line">         	<span class="comment">//如果较小值小于当前值，则不进行计算</span></div><div class="line">		res += min &gt; arr[i] ? (min - arr[i]) : <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="解法二"><a href="#解法二" class="headerlink" title="解法二"></a>解法二</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getWater1</span><span class="params">(<span class="keyword">int</span>[] arr)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span>[] rightMax = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</div><div class="line">	<span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = arr.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">	&#123;	<span class="comment">//计算从i+1 到n 最大值</span></div><div class="line">		rightMax[i] = max = arr[i] &gt; max ? arr[i] : max;</div><div class="line">	&#125;</div><div class="line">     	<span class="comment">//max 存放从0到 i-1中的最大值</span></div><div class="line">	max = arr[<span class="number">0</span>];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr.length - <span class="number">1</span>; i++)</div><div class="line">	&#123;	<span class="comment">//求出左侧和右侧两遍最大值中的较小值</span></div><div class="line">		<span class="keyword">int</span> min = max &gt; rightMax[i + <span class="number">1</span>] ? rightMax[i + <span class="number">1</span>] : max;</div><div class="line">		res += min &gt; arr[i] ? (min - arr[i]) : <span class="number">0</span>;</div><div class="line">		<span class="comment">// 更新左侧的最大值</span></div><div class="line">		max = arr[i] &gt; max ? arr[i] : max;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="解法三："><a href="#解法三：" class="headerlink" title="解法三："></a>解法三：</h4><p>思路：用leftMax记录当前左侧访问到的的最大值，用rightMax记录当前访问到的右侧最大值。</p>
<ol>
<li><p>​</p>
<p>leftMax=6                                       rightMax=7</p>
<p><code>6</code>、5、7、4、3……5、7、3、9、8、<code>7</code></p>
<pre><code>left=5                                     right=8
</code></pre><p>当leftMax&lt;rightMax时，左侧的成为瓶颈，计算left=5所能盛水的量 value= leftMax-5=1，left向前移动</p>
</li>
<li><p>​</p>
<p>leftMax=6                                       rightMax=7</p>
<p><code>6</code>、5、10、4、3……5、7、3、9、8、<code>7</code></p>
<pre><code>left=10                                   right=8
</code></pre><p>leftMax还是大于rightMax，还是左侧的是瓶颈，计算left=10所能盛水的量，由于leftMax&lt;left，所以不能盛水，更新leftMax=10，left向前移动</p>
</li>
<li><p>​</p>
<p>leftMax=10                                      rightMax=7</p>
<p>6、5、<code>10</code>、4、3……5、7、3、9、8、<code>7</code></p>
<pre><code>left=4                               right=8
</code></pre><p>leftMax大于rightMax，右侧成为瓶颈,计算right=8的盛水量，rightMax&lt;right,所以不能盛水，更新rightMax=8，right向前移动</p>
<p>………………</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getWater2</span><span class="params">(<span class="keyword">int</span>[] arr)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> leftMax = arr[<span class="number">0</span>], rightMax = arr[arr.length - <span class="number">1</span>];</div><div class="line">	<span class="keyword">int</span> left = <span class="number">1</span>, right = arr.length - <span class="number">2</span>;</div><div class="line">	<span class="keyword">while</span> (left &lt; right)</div><div class="line">	&#123;	</div><div class="line">		<span class="keyword">if</span> (leftMax &lt;= rightMax)</div><div class="line">		&#123;	<span class="comment">//左侧最大值小于右侧最大值，计算left的盛水量</span></div><div class="line">			<span class="keyword">if</span> (leftMax &gt; arr[left])</div><div class="line">				res += leftMax - arr[left];</div><div class="line">			<span class="keyword">else</span>	<span class="comment">//leftMax小于left 则更新最大值</span></div><div class="line">				leftMax = arr[left];</div><div class="line">			left++;</div><div class="line">		&#125; <span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (rightMax &gt; arr[right])</div><div class="line">				res += rightMax - arr[right];</div><div class="line">			<span class="keyword">else</span></div><div class="line">				rightMax = arr[right];</div><div class="line">			right--;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>